# æ•°æ®ä¿®å¤å·¥å…·ä½¿ç”¨è¯´æ˜

## 1. ä»£ç æ”¹è¿›ï¼ˆå·²å®Œæˆï¼‰âœ…

å·²ä¸ºä»¥ä¸‹å‡½æ•°æ·»åŠ äº†é‡è¯•æœºåˆ¶ï¼š
- `translate_summary()` - ç¿»è¯‘æ‘˜è¦ï¼ˆæœ€å¤šé‡è¯• 3 æ¬¡ï¼‰
- `generate_summary()` - ç”Ÿæˆæ€»ç»“ï¼ˆæœ€å¤šé‡è¯• 3 æ¬¡ï¼‰
- `generate_inspiration_trace()` - ç”Ÿæˆçµæ„Ÿæº¯æºï¼ˆæœ€å¤šé‡è¯• 3 æ¬¡ï¼‰
- `generate_daily_overview()` - ç”Ÿæˆæ¯æ—¥é€Ÿè§ˆï¼ˆæœ€å¤šé‡è¯• 3 æ¬¡ï¼‰

**é‡è¯•ç­–ç•¥**ï¼š
- æœ€å¤§é‡è¯•æ¬¡æ•°ï¼š3 æ¬¡
- é€€é¿ç­–ç•¥ï¼šæŒ‡æ•°é€€é¿ï¼ˆ2ç§’ â†’ 4ç§’ â†’ 8ç§’ï¼‰
- å¯é‡è¯•é”™è¯¯ï¼šConnection error, timeout, Rate limit, 502/503 ç­‰

## 2. ä¿®å¤å¤±è´¥ä»»åŠ¡è„šæœ¬

### åŸºæœ¬ç”¨æ³•

```bash
# 1. æ£€æµ‹æ‰€æœ‰æ–‡ä»¶çš„å¤±è´¥ä»»åŠ¡ï¼ˆä¸ä¿®å¤ï¼‰
python3 fix_failed_tasks.py --dry-run

# 2. ä¿®å¤æ‰€æœ‰å¤±è´¥ä»»åŠ¡
python3 fix_failed_tasks.py

# 3. åªä¿®å¤çµæ„Ÿæº¯æºå¤±è´¥çš„ä»»åŠ¡
python3 fix_failed_tasks.py --type inspiration

# 4. åªä¿®å¤ç¿»è¯‘å¤±è´¥çš„ä»»åŠ¡
python3 fix_failed_tasks.py --type translation

# 5. ä¿®å¤æŒ‡å®šæ–‡ä»¶
python3 fix_failed_tasks.py --file summary/filtered_papers_2025-12-19_with_summary2.json

# 6. ä¿®å¤ç‰¹å®šæ—¥æœŸèŒƒå›´çš„æ–‡ä»¶
python3 fix_failed_tasks.py --pattern "filtered_papers_2025-12-*_with_summary2.json"
```

### å‚æ•°è¯´æ˜

- `--file`: æŒ‡å®šè¦ä¿®å¤çš„å•ä¸ªæ–‡ä»¶
- `--dir`: summary ç›®å½•è·¯å¾„ï¼ˆé»˜è®¤: summaryï¼‰
- `--type`: è¦ä¿®å¤çš„ä»»åŠ¡ç±»å‹
  - `all`: ä¿®å¤æ‰€æœ‰å¤±è´¥ä»»åŠ¡ï¼ˆé»˜è®¤ï¼‰
  - `inspiration`: åªä¿®å¤çµæ„Ÿæº¯æº
  - `translation`: åªä¿®å¤ç¿»è¯‘
  - `summary`: åªä¿®å¤æ€»ç»“
- `--dry-run`: åªæ£€æµ‹ä¸ä¿®å¤
- `--pattern`: æ–‡ä»¶ååŒ¹é…æ¨¡å¼

### ä½¿ç”¨ç¤ºä¾‹

#### åœºæ™¯1ï¼šæ£€æŸ¥æ‰€æœ‰æ–‡ä»¶çš„å¤±è´¥æƒ…å†µ

```bash
# æ¿€æ´»ç¯å¢ƒ
source /home/xuanli/miniconda3/etc/profile.d/conda.sh
conda activate alphaapollo
export http_proxy=http://127.0.0.1:1087 https_proxy=http://127.0.0.1:1087

# æ£€æµ‹å¤±è´¥ä»»åŠ¡
python3 fix_failed_tasks.py --dry-run
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ“Š å¤±è´¥ä»»åŠ¡ç»Ÿè®¡:
  - çµæ„Ÿæº¯æºå¤±è´¥: 5 ç¯‡
  - ç¿»è¯‘å¤±è´¥: 4 ç¯‡
  - æ€»ç»“å¤±è´¥: 0 ç¯‡
  - å…¨éƒ¨å¤±è´¥: 0 ç¯‡
```

#### åœºæ™¯2ï¼šä¿®å¤ç‰¹å®šæ—¥æœŸçš„å¤±è´¥ä»»åŠ¡

```bash
# ä¿®å¤ 2025-12-19 çš„å¤±è´¥ä»»åŠ¡
python3 fix_failed_tasks.py --file summary/filtered_papers_2025-12-19_with_summary2.json

# ä¿®å¤ 12 æœˆæ‰€æœ‰æ—¥æœŸçš„å¤±è´¥ä»»åŠ¡
python3 fix_failed_tasks.py --pattern "filtered_papers_2025-12-*_with_summary2.json"
```

#### åœºæ™¯3ï¼šåªä¿®å¤çµæ„Ÿæº¯æº

```bash
# åªä¿®å¤çµæ„Ÿæº¯æºå¤±è´¥çš„è®ºæ–‡
python3 fix_failed_tasks.py --type inspiration
```

## 3. æ‰¹å¤„ç†è„šæœ¬

### batch_fix_all.sh
è‡ªåŠ¨å¤„ç†æ‰€æœ‰ç¼ºå¤±æ—¥æœŸçš„æ•°æ®ï¼ˆå·²åœ¨è¿è¡Œä¸­ï¼‰

```bash
# æŸ¥çœ‹è¿›åº¦
tail -f fix_progress.log

# æ£€æŸ¥è„šæœ¬æ˜¯å¦åœ¨è¿è¡Œ
ps aux | grep batch_fix_all.sh | grep -v grep
```

## 4. å®Œæ•´ä¿®å¤æµç¨‹

### æ­¥éª¤1ï¼šç­‰å¾…æ‰¹å¤„ç†è„šæœ¬å®Œæˆ
```bash
# ç›‘æ§è¿›åº¦
tail -f fix_progress.log

# ç­‰å¾…è„šæœ¬å®Œæˆåï¼Œæ£€æŸ¥æ˜¯å¦è¿˜åœ¨è¿è¡Œ
ps aux | grep batch_fix_all.sh
```

### æ­¥éª¤2ï¼šæ£€æµ‹å¤±è´¥ä»»åŠ¡
```bash
source /home/xuanli/miniconda3/etc/profile.d/conda.sh
conda activate alphaapollo
export http_proxy=http://127.0.0.1:1087 https_proxy=http://127.0.0.1:1087

# æ£€æµ‹å¤±è´¥ä»»åŠ¡
python3 fix_failed_tasks.py --dry-run
```

### æ­¥éª¤3ï¼šä¿®å¤å¤±è´¥ä»»åŠ¡
```bash
# ä¿®å¤æ‰€æœ‰å¤±è´¥ä»»åŠ¡
python3 fix_failed_tasks.py
```

### æ­¥éª¤4ï¼šé‡æ–°ç”Ÿæˆç»Ÿä¸€ç½‘é¡µ
```bash
# é‡æ–°ç”Ÿæˆç½‘é¡µç´¢å¼•
python3 src/core/generate_unified_index.py
```

### æ­¥éª¤5ï¼šæäº¤æ›´æ–°
```bash
# æŸ¥çœ‹ä¿®æ”¹
git status
git diff

# æäº¤æ›´æ–°
git add .
git commit -m "Fix missing data and failed tasks (2025-12-19 to 2026-01-07)"
git push origin master
```

## 5. æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šConnection error ä»ç„¶å‡ºç°
**åŸå› **ï¼šç½‘ç»œä¸ç¨³å®šæˆ– API é™æµ
**è§£å†³**ï¼š
- æ£€æŸ¥ä»£ç†è®¾ç½®
- å¢åŠ é‡è¯•æ¬¡æ•°ï¼ˆä¿®æ”¹ `fix_failed_tasks.py` ä¸­çš„ `max_retries` å‚æ•°ï¼‰
- ç­‰å¾…ä¸€æ®µæ—¶é—´åå†é‡è¯•

### é—®é¢˜2ï¼šä¿®å¤è„šæœ¬è¿è¡Œç¼“æ…¢
**åŸå› **ï¼šéœ€è¦è°ƒç”¨ API ç”Ÿæˆå†…å®¹
**è§£å†³**ï¼š
- ä½¿ç”¨ `--type` å‚æ•°åªä¿®å¤ç‰¹å®šç±»å‹çš„ä»»åŠ¡
- ä½¿ç”¨ `--pattern` å‚æ•°åªä¿®å¤ç‰¹å®šæ—¥æœŸçš„æ–‡ä»¶

### é—®é¢˜3ï¼šéƒ¨åˆ†ä»»åŠ¡ä»ç„¶å¤±è´¥
**åŸå› **ï¼šAPI å®Œå…¨ä¸å¯ç”¨æˆ–è®ºæ–‡å†…å®¹æ— æ³•è·å–
**è§£å†³**ï¼š
- æ£€æŸ¥ Jina API æ˜¯å¦å¯ç”¨
- æ£€æŸ¥ OpenAI API æ˜¯å¦æ­£å¸¸
- æ‰‹åŠ¨æ£€æŸ¥å¤±è´¥çš„è®ºæ–‡é“¾æ¥æ˜¯å¦æœ‰æ•ˆ

## 6. æ³¨æ„äº‹é¡¹

1. **ä»£ç†è®¾ç½®**ï¼šè¿è¡Œå‰ç¡®ä¿è®¾ç½®äº†æ­£ç¡®çš„ä»£ç†
2. **API é™æµ**ï¼šè„šæœ¬ä¼šè‡ªåŠ¨å¤„ç†é€Ÿç‡é™åˆ¶ï¼Œä½†å¤§é‡å¤±è´¥ä»»åŠ¡å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´
3. **ç¼“å­˜æœºåˆ¶**ï¼šå·²æˆåŠŸçš„å†…å®¹ä¼šè¢«ç¼“å­˜ï¼Œé‡å¤è¿è¡Œä¸ä¼šé‡å¤è¯·æ±‚
4. **å¤‡ä»½æ•°æ®**ï¼šä¿®å¤å‰å»ºè®®å¤‡ä»½ summary ç›®å½•
